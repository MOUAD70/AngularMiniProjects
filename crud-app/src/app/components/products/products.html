<div class="container my-5">
  @if (errorMsg) {
  <div class="alert alert-danger">
    {{ errorMsg }}
  </div>
  } @else {
  <input
    class="form-control mb-3"
    placeholder="Search product..."
    [(ngModel)]="search"
    (ngModelChange)="handleSearchProducts()"
  />

  <div class="card shadow-sm border-0">
    <!-- Card Header -->
    <div
      class="card-header bg-secondary text-white d-flex justify-content-between align-items-center"
    >
      <h5 class="mb-0">Products List</h5>
      <span class="badge bg-success">{{ products.length }} Product!</span>
    </div>

    <!-- Table -->
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>#ID</th>
            <th>NAME</th>
            <th class="text-end">PRICE (MAD)</th>
            <th class="text-end">PROMOTION</th>
            <th class="text-end">ACTIONS</th>
          </tr>
        </thead>

        <tbody>
          @for(product of products; track product.id) {
          <tr>
            <td class="fw-semibold">{{ product.id }}</td>
            <td>
              <i class="bi bi-box-seam me-2 text-primary"></i>
              {{ product.name }}
            </td>
            <td class="text-end fw-bold text-success">{{ product.price }} DH</td>

            @if (product.promotion === true) {
            <td class="text-end">
              <i class="bi bi-tag-fill text-success"></i>
              <button (click)="handleSetPromotion(product)" class="btn btn-outline-danger mx-2">
                DISABLE PROMOTION
              </button>
            </td>
            } @else {
            <td class="text-end">
              <i class="bi bi-tag text-danger"></i>
              <button (click)="handleSetPromotion(product)" class="btn btn-outline-success mx-2">
                ENABLE PROMOTION
              </button>
            </td>
            }
            <td class="text-end">
              <button (click)="handleDeleteProduct(product)" class="btn btn-danger">
                <i class="bi bi-trash mx-2"></i>
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    <nav aria-label="Products pagination">
      <ul class="pagination pagination-sm justify-content-center my-2">
        <!-- Prev -->
        <li class="page-item" [class.disabled]="currentPage === 0">
          <a
            class="page-link"
            href="#"
            (click)="$event.preventDefault(); gotoPage(currentPage - 1)"
          >
            «
          </a>
        </li>

        <!-- Pages -->
        @for (_ of [].constructor(totalPages); track $index) {
        <li class="page-item" [class.active]="$index === currentPage">
          <a class="page-link" href="#" (click)="$event.preventDefault(); gotoPage($index)">
            {{ $index + 1 }}
          </a>
        </li>
        }

        <!-- Next -->
        <li class="page-item" [class.disabled]="currentPage >= totalPages - 1">
          <a
            class="page-link"
            href="#"
            (click)="$event.preventDefault(); gotoPage(currentPage + 1)"
          >
            »
          </a>
        </li>
      </ul>
    </nav>

    <!-- Card Footer -->
    <div class="card-footer text-end bg-light">
      <strong>Total Products: {{ products.length }}</strong>
    </div>
  </div>
  }
</div>
